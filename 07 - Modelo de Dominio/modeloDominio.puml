@startuml modeloDominio
' Modelo de dominio - Farmacia (sin Afiliacion; snapshot de obra social en Venta)

skinparam classAttributeIconSize 0
skinparam classFontSize 12
skinparam noteFontSize 11

class Medicamento {
  + codBarra : INT
    nombreMed : VARCHAR
    (descripcion) : TEXT
    laboratorio : VARCHAR
    precioMedUnitario : DECIMAL
    stock : INT
}

class Usuario {
    nombreUsuario : VARCHAR
    contrase침a : VARCHAR
    tipoUsuario : ENUM {administrador, empleado}
    montoTotalVendido : DECIMAL
}

class Empleado {
    nombre : VARCHAR
    apellido : VARCHAR
    sueldo : DECIMAL
    montoTotalVendido : DECIMAL
}

class Asistencia {
    fecha : DATE
    (horaEntrada) : TIME
    (horaSalida) : TIME
    estado : ENUM {presente, ausente, tarde, licencia}
}

class Cliente {
    nombreCliente : VARCHAR
    apellidoCliente : VARCHAR
    dni : VARCHAR
    (email) : VARCHAR
    (numTel) : VARCHAR
    (saldoCtaCorriente) : DECIMAL
    esFrecuente : BOOLEAN
}

class ObraSocial {
    nomObraSocial : VARCHAR
    fechaPrescripcion : DATE
    fechaVta : DATETIME
    matriculaMedico : VARCHAR
    productosRecetados : VARCHAR ENUM {1...X}
}

' Receta: entidad para validar prescripciones y evitar doble dispensaci칩n
class Receta {
  + idReceta : INT
    numReceta (opt) : VARCHAR
    fechaPrescripcion : DATE
    matriculaMedico : VARCHAR
    usada : BOOLEAN
    fechaUso (opt) : DATETIME
    idVentaUso (opt) : INT
}

class Venta {
    tipoVta : ENUM {particular, obraSocial}
    fechaVta : DATETIME
    montoTotal : DECIMAL
    tipoPago : ENUM {efectivo, debito, credito, transferencia, billetera}
    Cliente : Class
    (cuotas) : INT
}

class DetalleVenta {
    Medicamento : Class ENUM {1...X}
    cantidad : INT ENUM {1...X}
    montoFinal : DECIMAL
}

class Ticket {
    nombreFarmacia : VARCHAR
    direccion : VARCHAR
    telefono : VARCHAR
    fechaHoraImpresion : DATETIME
    DetalleVenta : Class
}

' Asociaciones / multiplicidades
Venta "1" -- "1..X" DetalleVenta : Contiene >
DetalleVenta "*" -- "1" Medicamento : Referencia >
Empleado "1" -- "0..X" Venta : Realiza >
Venta "0..X" -- "1" Cliente : Asociado (O no) >
Cliente "0..X" -- "1" ObraSocial : Registrado (O no) >
Cliente "1" -- "0..*" Receta : Posee (o no) >
Receta "1" -- "0..*" DetalleVenta : Cubre >
DetalleVenta "0..1" -- "0..1" Receta : Si el medicamento aplica receta >
ObraSocial "0..X" -- "1" Receta : Relaciona (O no) >
Receta "0..*" -- "1" ObraSocial : Asocia (O no) >
Usuario "1" -- "0..1" Empleado : Vincula >
Empleado "1" -- "0..X" Asistencia : Registra >
Venta "1" -- "0..1" Ticket : genera >

' Notas
note right of Empleado
  - Un Usuario con rol "empleado" no puede registrar la asistencias
  de los empleados ni ver toda la
  parte de gesti칩n, s칩lo los usuarios
  con el rol "administrador".
end note

@enduml
