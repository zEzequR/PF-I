@startuml
actor Administrador
participant "UI Empleados" as UI
participant "NegocioControlador" as NC
participant Usuario as U
participant Empleado as E
database BaseDatos

== Acceso al módulo ==
Administrador -> UI : abrirModuloGestionEmpleados()

== Iniciar alta ==
Administrador -> UI : seleccionarAgregarEmpleado()
UI -> Administrador : mostrarFormulario()

== Ingreso de datos ==
Administrador -> UI : ingresarDatos(nombreUsuario, contraseña, tipoUsuario)

== Validación ==
UI -> NC : crearUsuario(nombreUsuario, contraseña, tipoUsuario)
NC -> U : validarDatos()

alt Datos inválidos o incompletos
    U --> NC : errorValidacion
    NC --> UI : mostrarMensaje("Datos obligatorios faltantes o inválidos")
    return
end

== Verificar duplicado ==
NC -> U : getUsuario(nombreUsuario)
U -> BaseDatos : SELECT * FROM Usuario WHERE nombreUsuario = ?
BaseDatos --> U : usuarioExiste / noExiste

alt Usuario ya registrado
    U --> NC : usuarioDuplicado
    NC --> UI : mostrarMensaje("Empleado ya registrado")
    return
end

== Crear Usuario ==
NC -> U : setUsuario(nombreUsuario, contraseña)
U -> BaseDatos : INSERT INTO Usuario(...)
alt Error BD en usuario
    BaseDatos --> U : error
    U --> NC : errorBD
    NC --> UI : "Error al agregar nuevo empleado. Intente nuevamente más tarde"
    return
end
BaseDatos --> U : OK

== Crear Empleado ==
NC -> E : setEmpleado(nombreUsuario, montoVendido, tipoUsuario)
E -> BaseDatos : INSERT INTO Empleado(...)
alt Error BD al crear empleado
    BaseDatos --> E : error
    E --> NC : errorBD
    NC --> UI : "Error al agregar nuevo empleado. Intente nuevamente más tarde"
    return
end
BaseDatos --> E : OK

== Confirmación ==
NC --> UI : mostrarMensaje("Empleado registrado con éxito")

UI --> Administrador : mostrarEmpleadoNuevo()

@enduml
