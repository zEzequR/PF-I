@startuml
actor Administrador
participant "UI Medicamentos" as UI
participant "NegocioControlador" as NC
participant Medicamento as M
database BaseDatos

== Acceso al módulo ==
Administrador -> UI : abrirModuloGestionMedicamentos()

== Iniciar alta ==
Administrador -> UI : seleccionarAgregarMedicamento()
UI -> Administrador : mostrarFormulario()

== Ingreso de datos ==
Administrador -> UI : ingresarDatos(codBarra, nombre, descripcion, laboratorio, precioUnitario, stock)

== Validación de datos ==
UI -> NC : crearMedicamento(codBarra, nombre, precioUnitario, stock, laboratorio)
NC -> M : validarDatos()

alt Datos incompletos o inválidos
    M --> NC : errorValidacion
    NC --> UI : mostrarMensaje("Datos incompletos o con formato incorrecto")
    return
end

== Preparar guardado ==
NC -> M : setMedicamento(datos)

== Guardar medicamento ==
M -> BaseDatos : INSERT INTO Medicamento(...)
alt Error de conexión o fallo BD
    BaseDatos --> M : error
    M --> NC : errorBD
    NC --> UI : "Error al guardar. Intente nuevamente más tarde"
    return
end

BaseDatos --> M : OK

== Confirmación ==
NC --> UI : mostrarMensaje("Medicamento registrado con éxito")

UI --> Administrador : mostrarMedicamentoNuevo()

@endum