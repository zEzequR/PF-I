@startuml
title DSD - Asistencia de empleados 

actor Administrador
control ControladorNegocio
entity Empleado
entity Asistencia
entity Sistema

== Inicio ==

Administrador -> ControladorNegocio: accederModuloAsistencia()

ControladorNegocio -> Empleado: obtenerEmpleados()
activate Empleado
Empleado --> ControladorNegocio: listaEmpleados
deactivate Empleado

alt Error al obtener empleados
    ControladorNegocio -> Administrador: mensaje("Error al obtener empleados")

else Lista obtenida
    ControladorNegocio -> Sistema: mostrarListaEmpleados(listaEmpleados)
    activate Sistema
    Sistema -> Administrador: mostrar(listaEmpleados)
    deactivate Sistema

    Administrador -> ControladorNegocio: seleccionarEmpleados(listaSeleccionados)

    loop Para cada empleado seleccionado
        Administrador -> ControladorNegocio: registrarAsistencia(Fecha, HoraEntrada, HoraSalida, Estado)

        ControladorNegocio -> Sistema: validarDatos(Fecha, HoraEntrada, HoraSalida, Estado)
        activate Sistema
        Sistema --> ControladorNegocio: datosCompletos
        deactivate Sistema

        alt Datos incompletos
            ControladorNegocio -> Administrador: mensaje("Complete todos los campos requeridos")

        else Datos completos
            ControladorNegocio -> Asistencia: crearAsistencia(Fecha, HoraEntrada, HoraSalida, Estado)
            activate Asistencia
            Asistencia --> ControladorNegocio: asistencia
            deactivate Asistencia
        end
    end

    ControladorNegocio -> Sistema: guardarAsistencias(asistencia)
    activate Sistema
    Sistema --> ControladorNegocio: guardado
    deactivate Sistema

    alt Faltan asistencias
        ControladorNegocio -> Administrador: mensaje("Complete la asistencia de todos los empleados")
    else Registro exitoso
        ControladorNegocio -> Administrador: mensaje("Asistencia registrada correctamente")
    end

    deactivate ControladorNegocio
end

@enduml
