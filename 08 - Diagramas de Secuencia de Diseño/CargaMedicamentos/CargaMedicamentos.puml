@startuml
<<<<<<< Updated upstream
title Carga de Medicamentos (Alta)
=======
title Carga de Medicamentos
>>>>>>> Stashed changes

hide footbox

actor "Administrador:Admin" as admin
<<<<<<< Updated upstream
participant "gc:gestionControlador" as ctrl
participant "cat:<<Singleton>>\nCatalogoMedicamentos" as cat
participant "medActual:Medicamento" as med_actual
participant "nuevoMed:Medicamento" as nuevo_med

admin -> ctrl : nuevoMedicamento(codigoBarra, nombre, controlado, drogueriaNombre, precioUnitario, stock)
activate ctrl

ctrl -> cat : buscarMedicamento(codigoBarra)
activate cat

loop [para cada m en medicamentos]
    cat -> med_actual : getCodigoBarra()
    activate med_actual
    med_actual --> cat : << codActual : String >>
    deactivate med_actual
    
    alt codBarra == codActual
        cat --> ctrl : << m : Medicamento >>
        deactivate cat
        
        ctrl --> admin : << "Error: Medicamento ya registrado" >>

    else codBarra != codActual

        deactivate cat
        
        ctrl -> nuevo_med : crearMedicamento(codigoBarra, nombre, controlado, drogueriaNombre, precioUnitario, stock)
        activate nuevo_med
        nuevo_med --> ctrl : << nuevoMed : Medicamento >>
        deactivate nuevo_med

        ctrl -> cat : agregarMedicamento(nuevoMed)
        activate cat
        
        cat --> ctrl : << null >>
        deactivate cat
        
        ctrl --> admin : << "Ã‰xito: Medicamento guardado" >>
        
    end
end

deactivate ctrl
=======
participant "NegCtrl: Interfaz" as NegCtrl

participant "List<Medicamento>: objListaMedicamentos" as lista
participant "Medicamento: objMedicamento" as med
participant "Medicamento: nuevoMedicamento" as newMed

admin -> NegCtrl : registrarMedicamento(codBarras: String, nombre: String, descripcion: String, drogueria: String, precio: Float, stock: Int)
activate NegCtrl

    alt datos incompletos o formato incorrecto
        NegCtrl --> admin : <<NULL>>
    else datos vÃ¡lidos
    
        NegCtrl -> lista : buscarMedicamento(codBarras: String)
        activate lista
        
        loop [para cada m en objListaMedicamentos]
            lista -> med : getCodBarras()
            activate med
            med --> lista : << codigoActual : String >>
            deactivate med
            
            alt codBarras == codigoActual
                lista --> NegCtrl : << objMedicamentoEncontrado : Medicamento >>
            end
        end
        deactivate lista
        
        alt objMedicamentoEncontrado != null
            NegCtrl --> admin : <<NULL>>
            
        else objMedicamentoEncontrado == null

            NegCtrl -> newMed ** : create(codBarras: String, nombre: String, descripcion: String, drogueria: String, precio: Float, stock: Int)
            activate newMed
            newMed --> NegCtrl : << nuevoMedicamento : Medicamento >>
            deactivate newMed

            NegCtrl -> lista : agregarMedicamento(nuevoMedicamento: Medicamento)
            activate lista
            lista --> NegCtrl : << estado : Boolean >>
            deactivate lista

            NegCtrl --> admin : <<NULL>>
        end
        
    end

deactivate NegCtrl
>>>>>>> Stashed changes
@enduml