@startuml
title Carga de Medicamentos

hide footbox

actor "Administrador:Admin" as admin
participant "gc:GestionControlador" as ctrl
participant "cat:<<Singleton>>\nCatalogoMedicamentos" as cat
participant "medActual:Medicamento" as med_actual

admin -> ctrl : registrarMedicamento(codigoBarra: int, nombre: String, descripcion: String, drogueriaNombre: String, precioUnitario: float, stock: int)
activate ctrl

ctrl -> cat : buscarMedicamento(codigoBarra)
activate cat

loop [para cada m en medicamentos]
    cat -> med_actual : getCodigoBarra()
    activate med_actual
    med_actual --> cat : << codActual : int >>
    deactivate med_actual
    
    alt codigoBarra == codActual
        cat --> ctrl : << m : Medicamento >>
        deactivate cat
        ctrl --> admin : << "Error: Medicamento ya registrado" >>

    else codigoBarra != codActual
        deactivate cat
        
        create participant "nuevoMed:Medicamento" as nuevo_med
        ctrl -> nuevo_med : CrearMedicamento(codigoBarra: int, nombre: String, descripcion: String, drogueriaNombre: String, precioUnitario: float, stock: int)
        activate nuevo_med
        nuevo_med --> ctrl : << nuevoMed : Medicamento >>
        deactivate nuevo_med

        ctrl -> cat : agregarMedicamento(nuevoMed)
        activate cat
        cat --> ctrl : << null >>
        deactivate cat
        
        ctrl --> admin : << "Ã‰xito: Medicamento guardado" >>
    end
end

deactivate ctrl
@enduml